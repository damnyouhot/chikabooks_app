# 🎨 Chikabooks 디자인 컨셉 지침

> **어제부터 적용된 감성 UX 디자인 가이드라인**
> 
> 이 문서는 Chikabooks 앱의 "돌보기(Caring)" 페이지 및 전반적인 UX 디자인 철학을 정리합니다.

---

## 📌 핵심 디자인 철학

### 1. **감성 중심, 죄책감 배제**
- ❌ "오랜만이네요. 어디 갔었어요?" → 죄책감 유발 금지
- ✅ "오랜만이다… 돌아와줘서 고마워. 여기 그대로 있었어."
- **원칙**: 유저를 압박하거나 불안하게 만들지 않는다. 항상 공감과 위로 중심.

### 2. **티 안 나게 세심하게**
- 모든 피드백은 **흐릿하고 부드럽게**
- 숫자/통계는 **절대 강조하지 않음** (opacity 0.5 이하)
- 애니메이션은 **자연스럽고 우아하게** (바람에 휘날리듯)

### 3. **말할 때만 말한다**
- 멘트는 **상시 노출 ❌**
- 이벤트 발생 시에만 **페이드 인 → 잠시 유지 → 바람 효과로 사라짐**
- 사용자가 읽을 시간을 충분히 주되, 화면을 어지럽히지 않음

---

## 🎬 애니메이션 규격

### 말풍선 (SpeechOverlay)

```
페이드 인: 250ms (Curves.easeOut)
유지 시간: 1800~2500ms (멘트 길이에 따라 가변)
페이드 아웃: 250ms (바람 효과)
```

**바람 효과 (Wind Dismiss):**
- **translate**: (0, 0) → (+14px, -6px) - 오른쪽 위로 살짝
- **rotate**: 0° → 3~4° (0.05 rad)
- **blur**: 0 → 3px
- **opacity**: 1.0 → 0.0

**구현:**
```dart
Transform.translate + Transform.rotate + ImageFiltered(blur) + Opacity
```

### 떠오르는 수치 (FloatingDelta)

```
위치 이동: +18px 위로 (1초 동안)
opacity: 0.0 → 0.5 → 0.0
시작 위치: 캐릭터 머리 위 20~40px
```

**특징:**
- 최대 불투명도 0.5 (절대 선명하지 않음)
- 작은 글자 (14px)
- 그림자 효과로 가독성 확보
- 1초 후 자동 제거

---

## 🎨 컬러 팔레트

### 돌보기 페이지 전용

```dart
_colorAccent = Color(0xFFF7CBCA)    // 미술적 포인트 (연한 핑크)
_colorText = Color(0xFF5D6B6B)       // 텍스트/메시지 (청회색)
_colorBg = Color(0xFFF1F7F7)         // 메인 배경 (아주 연한 청록)
_colorShadow1 = Color(0xFFDDD3D8)    // 흐린 명암1
_colorShadow2 = Color(0xFFD5E5E5)    // 흐린 명암2
```

### 사용 원칙
- **강조 색상 최소화**: 핑크는 매우 제한적으로 사용
- **텍스트는 항상 청회색**: 강한 검정 사용 금지
- **버튼 테두리**: 0.5px 가느다란 라인
- **불투명도 적극 활용**: `withOpacity(0.4)`, `withOpacity(0.5)` 등

---

## 💬 멘트 작성 가이드

### ✅ 좋은 멘트 예시

```
"오늘도 여기."
"천천히 해도 괜찮아."
"숨 한 번."
"있는 그대로."
"지금은 멈춰도 돼. 멈추는 건 포기가 아니라 정비야."
"너는 생각보다 훨씬 단단해."
"오늘 하루, 꼭 멋지지 않아도 돼. 무사히 지나가면 돼."
```

### ❌ 피해야 할 멘트

```
❌ "오늘도 안 했네요?" (압박)
❌ "진짜 열심히 해야죠!" (강요)
❌ "다른 사람들은 다 했는데…" (비교)
❌ "이제 그만 쉬고 시작할까요?" (재촉)
```

### 멘트 작성 원칙

1. **짧고 간결하게** (10자 이내 권장)
2. **명령형 ❌, 제안형 ✅**
3. **"너", "우리" 사용 ✅** / "당신" 사용 ❌
4. **현재형 중심** (과거 언급 최소화)
5. **구체적 수치/통계 언급 금지**

---

## 🔘 버튼 디자인

### 4버튼 구조 (돌보기 페이지)

| 아이콘 | 기능 | 설명 |
|--------|------|------|
| 🍚 `restaurant_outlined` | 밥먹기 | 기본 상호작용 |
| ❤️ `volunteer_activism` | **소통하기** | 유저 상태 공감 멘트 |
| 📝 `edit_note_outlined` | **대화하기** | 한 줄 기록 (나만 보기) |
| 🌙 `nights_stay_outlined` | 잠자기 | 디밍 상태 전환 |

### 버튼 스타일

```dart
width: 52px
height: 52px
shape: Circle
background: Colors.white.withOpacity(0.7)
border: 0.5px, _colorShadow2.withOpacity(0.5)
icon size: 22px
icon color: _colorText.withOpacity(0.6)
```

---

## 🧠 유저 상태 분석 (소통하기)

### 상태 카테고리 6가지

1. **A. 새벽/피곤** (tired)
   - 시간대: 0~6시
   - "오늘 표정이 조금 무거워 보여… 숨 한 번만 같이 쉬자."

2. **B. 스트레스/힘듦** (stressed)
   - 감정 로그 점수 낮음 (1~2점)
   - "오늘은 속도를 늦춰도 돼. 계속 달리는 사람만 강한 게 아니거든."

3. **C. 의욕/좋은 흐름** (motivated)
   - 감정 로그 점수 높음 (4~5점)
   - "기분이 살짝 올라온다! 그 흐름, 내가 더 크게 만들어줄까?"

4. **D. 오랜만 복귀** (returning)
   - 마지막 활동: 7일 이상
   - "오랜만이다… 돌아와줘서 고마워. 여기 그대로 있었어."

5. **E. 학습 많이 함** (studying)
   - 최근 7일 학습 60분 이상
   - "너 요즘 많이 애썼지. '수고했다'는 말, 꼭 해주고 싶었어."

6. **F. 기본 멘트** (neutral)
   - 조건 없음
   - "오늘은 작은 칭찬이 필요한 날 같아. 내가 해줄게: 잘하고 있어."

### 우선순위 순서

```
시간대 체크 → 오랜만 복귀 → 감정 기록 → 학습 활동 → 기본
```

---

## 📝 한 줄 기록 (대화하기)

### UI 구조

```
제목: "오늘 한마디"
서브타이틀: "나만 보는 기록이에요"
입력창: 최대 140자, 1~2줄
플레이스홀더: "지금 마음을 한 문장으로 남겨볼까?"
버튼: [취소] [저장]
```

### 저장 후 캐릭터 응답

**키워드 분석:**
- 짧음 (10자 이하): "짧게 말했지만 마음이 느껴져."
- 스트레스 키워드: "괜찮아. 너는 늘 최선을 다하고 있어."
- 긍정 키워드: "좋아! 이 흐름 유지해보자. 아주 작은 것부터."
- 기본: 24가지 응답 풀에서 랜덤

**응답 멘트 예시 (24개):**
```
"좋아, 이 문장… 오늘의 너를 잘 담았어."
"적어줘서 고마워. 마음이 조금은 가벼워졌으면."
"그 마음, 내가 기억해둘게."
"한 줄이면 충분해. 오늘은 이 정도면 돼."
"지금의 너를 있는 그대로 인정해주자."
...
```

---

## 🗄️ Firestore 구조

### users/{uid}/notes

```javascript
{
  text: string,           // 한 줄 기록 내용 (최대 140자)
  createdAt: timestamp,   // 서버 타임스탬프
  visibility: "private"   // 항상 private
}
```

### 보안 규칙

```javascript
match /users/{uid}/notes/{noteId} {
  allow read: if request.auth.uid == uid;
  allow write: if request.auth.uid == uid;
}
```

---

## 🎯 구현 체크리스트

### Phase 1: 새 위젯/서비스 생성
- [x] `lib/widgets/speech_overlay.dart` - 바람 효과 말풍선
- [x] `lib/widgets/floating_delta.dart` - 떠오르는 수치
- [x] `lib/widgets/diary_input_sheet.dart` - 한 줄 기록 팝업
- [x] `lib/services/speech_engine_service.dart` - 멘트 엔진

### Phase 2: caring_page.dart 개편
- [x] 새 위젯들 import
- [x] 상태 변수 추가
- [x] `_speak()` 및 `_showFloatingDelta()` 메서드
- [x] 핸들러 수정 (_onFeed, _onEmpathize, _onDiary)
- [x] UI 레이아웃 수정 (말풍선, 떠오르는 수치)
- [x] 4버튼 수정 (소통하기, 대화하기)

### Phase 3: Firestore & 배포
- [x] Firestore 보안 규칙 추가
- [x] Git 커밋 & 푸시
- [ ] 앱 테스트 (밥먹기/소통/대화/잠자기)
- [ ] 멘트 풀 확장 (추가 시나리오)

---

## 📚 참고 문서

### 커밋 히스토리
```
commit 2c520b5
✨ feat: 돌보기 페이지 감성 UX 개편
- 말풍선 시스템 (말할 때만 표시)
- 떠오르는 수치 표시
- 소통하기/대화하기 기능
- Firestore notes 컬렉션 추가
```

### 주요 파일
- `lib/pages/caring_page.dart` - 메인 페이지
- `lib/widgets/speech_overlay.dart` - 말풍선
- `lib/widgets/floating_delta.dart` - 수치 표시
- `lib/widgets/diary_input_sheet.dart` - 한 줄 기록
- `lib/services/speech_engine_service.dart` - 멘트 엔진
- `firestore.rules` - 보안 규칙

---

## 🚀 향후 확장 계획

1. **감정 로그 연동**
   - 오늘 감정 기록에 따라 멘트 자동 선택
   - "스트레스/힘듦" 카테고리 활성화

2. **학습 활동 연동**
   - 최근 7일 학습 시간 집계
   - "학습 많이 함" 카테고리 활성화

3. **멘트 풀 확장**
   - 카테고리별 50개 이상
   - 시즌별/이벤트별 특별 멘트

4. **한 줄 기록 히스토리**
   - 과거 기록 보기 기능
   - 월별 감정 트렌드 분석

5. **다른 페이지 적용**
   - 성장 페이지 감성 멘트
   - 파트너 페이지 공감 시스템

---

**마지막 업데이트**: 2026-02-13  
**작성자**: AI Assistant with User Guidance  
**버전**: 1.0.0

